(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/community/index"],{1382:function(n,e,t){"use strict";(function(n){t("82d0");o(t("66fd"));var e=o(t("d147"));function o(n){return n&&n.__esModule?n:{default:n}}n(e.default)}).call(this,t("543d")["createPage"])},"5ea8":function(n,e,t){"use strict";t.d(e,"b",(function(){return r})),t.d(e,"c",(function(){return i})),t.d(e,"a",(function(){return o}));var o={communityInfoComment:function(){return t.e("components/communityInfo-comment/communityInfo-comment").then(t.bind(null,"1ccc"))},uLoadmore:function(){return t.e("uview-ui/components/u-loadmore/u-loadmore").then(t.bind(null,"e233"))}},r=function(){var n=this,e=n.$createElement;n._self._c},i=[]},"64a3":function(n,e,t){"use strict";t.r(e);var o=t("b640"),r=t.n(o);for(var i in o)"default"!==i&&function(n){t.d(e,n,(function(){return o[n]}))}(i);e["default"]=r.a},b640:function(n,e,t){"use strict";(function(n){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o,r=a(t("a34a")),i=t("9a1e"),c=t("a25b");function a(n){return n&&n.__esModule?n:{default:n}}function u(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function s(n,e,t,o,r,i,c){try{var a=n[i](c),u=a.value}catch(s){return void t(s)}a.done?e(u):Promise.resolve(u).then(o,r)}function m(n){return function(){var e=this,t=arguments;return new Promise((function(o,r){var i=n.apply(e,t);function c(n){s(i,o,r,c,a,"next",n)}function a(n){s(i,o,r,c,a,"throw",n)}c(void 0)}))}}var d=function(){t.e("components/community-card/index").then(function(){return resolve(t("0762"))}.bind(null,t)).catch(t.oe)},f=function(){t.e("components/communityInfo-comment/communityInfo-comment").then(function(){return resolve(t("1ccc"))}.bind(null,t)).catch(t.oe)},l=(o={name:"",data:function(){return{info:"",comment:"",paging:"",status:"loading",Id:""}},methods:{},onLoad:function(n){var e=this;return m(r.default.mark((function t(){var o,c,a,u;return r.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,i.Community.getCommunityInfo(n.Id);case 2:return o=t.sent,200==o.code&&(e.info=o.data),t.next=6,i.Community.getCommunityComment(n.Id);case 6:return c=t.sent,t.next=9,c.getMoreData();case 9:a=t.sent,u=i.Community.makeImages(a.items,!1),e.comment=u,e.paging=c,c.moreData||(e.status="nomore"),c.accoumulator.length<20&&(e.status="nomore"),e.Id=n.Id;case 16:case"end":return t.stop()}}),t)})))()},onReachBottom:function(){var n=this;return m(r.default.mark((function e(){var t,o,c;return r.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(""!=n.paging){e.next=2;break}return e.abrupt("return");case 2:if(t=n.paging,!t.moreData){e.next=12;break}return e.next=6,t.getMoreData();case 6:o=e.sent,c=i.Community.makeImages(o.items,!1),n.comment=n.comment.concat(c),n.status="nomore",e.next=13;break;case 12:n.status="nomore";case 13:case"end":return e.stop()}}),e)})))()},onPullDownRefresh:function(){var e=this;return m(r.default.mark((function t(){var o,c,a;return r.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,i.Community.getCommunityComment(e.Id);case 2:return o=t.sent,t.next=5,o.getMoreData();case 5:c=t.sent,a=i.Community.makeImages(c.items,!1),e.comment=a,e.paging=o,o.moreData||(e.status="nomore"),n.showToast({title:"刷新完成",icon:"none"}),n.stopPullDownRefresh();case 12:case"end":return t.stop()}}),t)})))()},mounted:function(){}},u(o,"methods",{tapGoodTwo:function(n){var e=this;return m(r.default.mark((function t(){var o;return r.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,i.Community.sendCommentTwoGood(n.Id);case 2:o=t.sent,o&&(e.comment[n.index].twoComment[n.indexTwo].isGood=!n.isGood,1==e.comment[n.index].twoComment[n.indexTwo].isGood?e.comment[n.index].twoComment[n.indexTwo].good+=1:e.comment[n.index].twoComment[n.indexTwo].good-=1);case 4:case"end":return t.stop()}}),t)})))()},tapGood:function(n){var e=this;return m(r.default.mark((function t(){var o;return r.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,i.Community.sendCommentGood(n.Id);case 2:o=t.sent,o&&(e.comment[n.index].isGood=!n.isGood,1==e.comment[n.index].isGood?e.comment[n.index].good+=1:e.comment[n.index].good-=1);case 4:case"end":return t.stop()}}),t)})))()},sendComment:function(e){var t=this;return m(r.default.mark((function o(){var a,u,s;return r.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return o.next=2,i.Community.senComment({community_id:t.info.Id,comment_user_id:e.Id,content:e.content});case 2:a=o.sent,a&&(n.showToast({title:"评论成功"}),n.$emit("commentOk",{code:!0}),u=n.getStorageSync("userInfo"),s={Id:a.data.Id,avatar:u.avatar,content:e.content,create_time:(0,c.getTime)(),good:0,isGood:0,nickname:u.nickname,sign:u.sign,twoComment:[],user_id:u.Id,username:u.username},e.Id?t.comment[e.index]["twoComment"].unshift(s):(t.comment.unshift(s),t.info.comment+=1));case 4:case"end":return o.stop()}}),o)})))()},changeMoreSelect:function(e){return m(r.default.mark((function t(){var o;return r.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,i.Community.sendReport(e.Id);case 2:o=t.sent,200==o.code?n.showToast({title:"举报成功"}):n.showToast({title:o.msg,icon:"none"});case 4:case"end":return t.stop()}}),t)})))()},clickFollow:function(e){var t=this;return m(r.default.mark((function o(){return r.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return n.showLoading({title:"请求中"}),o.next=3,i.Community.sendFollow(e.Id);case 3:o.sent,n.hideLoading(),t,t.info.isFollow=!e.isFollow;case 7:case"end":return o.stop()}}),o)})))()},clickGood:function(e){var t=this;return m(r.default.mark((function o(){var c;return r.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return t.info.isGood=!e.isGood,0==e.isGood?t.info.good+=1:t.info.good-=1,o.next=4,i.Community.sendGood(e.Id);case 4:c=o.sent,c?n.vibrateShort({success:function(){console.log("抖动")}}):(t.info.isGood=!t.info.isGood,0==e.isGood?t.info.good-=1:t.info.good+=1);case 6:case"end":return o.stop()}}),o)})))()},clickCollection:function(e){var t=this;return m(r.default.mark((function o(){var c;return r.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return t.info.isCollection=!e.isCollection,0==e.isCollection?t.info.collection+=1:t.info.collection-=1,o.next=4,i.Community.sendCollection(e.Id);case 4:c=o.sent,c?n.vibrateShort({success:function(){console.log("抖动")}}):0==e.isCollection?t.info.collection-=1:t.info.collection+=1;case 6:case"end":return o.stop()}}),o)})))()}}),u(o,"components",{communityCard:d,communityInfoComment:f}),o);e.default=l}).call(this,t("543d")["default"])},d147:function(n,e,t){"use strict";t.r(e);var o=t("5ea8"),r=t("64a3");for(var i in r)"default"!==i&&function(n){t.d(e,n,(function(){return r[n]}))}(i);var c,a=t("f0c5"),u=Object(a["a"])(r["default"],o["b"],o["c"],!1,null,"c64b51e4",null,!1,o["a"],c);e["default"]=u.exports}},[["1382","common/runtime","common/vendor"]]]);